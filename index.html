<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Bingo </title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">


        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">

        <style>
        img {
            image-orientation: from-image;
        }
        </style>
    </head>
    <body>


        <p>Hello world! This is HTML5 Boilerplate.</p>

        <img src="img/cropped.jpg" id="bingo" />

        <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
        <!-- <script src="http://tenso.rs/tesseract.js"></script> -->
        <script src="ocrad.js"></script>
        <script src="annyang.js"></script>

        <script>

        var img = document.getElementById("bingo");

        // Tesseract.recognize(img, function(err, res) {
        //     console.log("Tesseract");
        //     console.log(res["text"]);
        // });

        var string = OCRAD(img);
        console.log("OCRAD");
        console.log(string);

        string = string.replace(/[^\d\n]+/g, "").replace(/ /g, "");
        var lines = string.split("\n");
        console.log(lines);

        var B = [];
        var I = [];
        var N = [];
        var G = [];
        var O = [];

        for (var i = 0; i < 5; i++) {
            var s = lines[i];
            if (i == 2) {
                // Special third row with free space
                if (s.length == 8) {
                    // Double-digit B column
                    B.push(s.slice(0,2));
                    I.push(s.slice(2,4));
                    G.push(s.slice(4,6));
                    O.push(s.slice(6,8));
                } else {
                    // Single-digit B column
                    B.push(s.slice(0,1));
                    I.push(s.slice(1,3));
                    G.push(s.slice(3,5));
                    O.push(s.slice(5,7));
                }
            } else {
                if (s.length == 10) {
                    // Double-digit B column
                    B.push(s.slice(0,2));
                    I.push(s.slice(2,4));
                    N.push(s.slice(4,6));
                    G.push(s.slice(6,8));
                    O.push(s.slice(8,10));
                } else {
                    // Single-digit B column
                    B.push(s.slice(0,1));
                    I.push(s.slice(1,3));
                    N.push(s.slice(3,5));
                    G.push(s.slice(5,7));
                    O.push(s.slice(7,9));
                }
            }
        };

        console.log(B);
        console.log(I);
        console.log(N);
        console.log(G);
        console.log(O);

        if (annyang) {
          // Let's define our first command. First the text we expect, and then the function it should call
          var commands = {
            'Bee *num': function(num) {
              console.log("B" + num);
            },
            'Eye *num': function(num) {
              console.log("I" + num);
            },
            'En *num': function(num) {
              console.log("N" + num);
            },
            'Gee *num': function(num) {
              console.log("G" + num);
            },
            'Oh *num': function(num) {
              console.log("O" + num);
            },
          };

          // Add our commands to annyang
          annyang.addCommands(commands);

          // Start listening. You can call this here, or attach this call to an event, button, etc.
          annyang.start();
        }

        </script>

    </body>
</html>
